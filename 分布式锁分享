数据库锁
sql 语句锁

sharding 锁
通过数据发现机器找到数据所在节点




5个节点


Redlock  半数获取锁就认为成功
A B C D E

比如说 ABC 持有锁1

此时 AB  和CDE 因为网络原因
分隔了

那么另一个客户端从CDE获取锁，

按道理 C有锁1此时是获取不到的
但是由于C的时钟跳跃 导致了
CDE可以获取锁成功
此时锁1 就同时被两个客户端占有了
那就导致了 业务紊乱

GC的例子
ABCDE

客户端1 获取到了锁
ABCDE 同时setNX
后面客户端1 发生了GC  执行了STW pause

ABCDE 过期了这个资源
此时客户端2 进行了获取操作 获取成功

这个时候呢 客户端1恢复了 继续执行业务
这个时候 就会导致 12 导致业务混乱
